# Deployment Guide for CinePro Backend

Your backend project is **too large** (>250 MB) for serverless platforms like Netlify and Vercel due to heavy dependencies (cheerio, cloudflare-scraper, etc.). 

This guide provides working deployment options for platforms that support full Node.js applications.

---

## ‚úÖ Option 1: Render.com (Recommended - Easiest)

**Perfect for this project. Free tier available with no size limits.**

### Quick Deploy Steps:

1. **Go to Render Dashboard:**
   Visit https://render.com/ and sign up/login

2. **Create New Web Service:**
   - Click "New +" ‚Üí "Web Service"
   - Connect your GitHub account if not already connected
   - Select repository: `lamdaz/backende`

3. **Configure Service:**
   Render will auto-detect settings from `render.yaml`, but verify:
   - **Name:** `cinepro-backend` (or your choice)
   - **Runtime:** Node
   - **Build Command:** `npm install`
   - **Start Command:** `node index.js`
   - **Plan:** Free

4. **Add Environment Variables:**
   - `TMDB_API_KEY`: Your TMDB API key from https://www.themoviedb.org/settings/api
   - `ALLOWED_ORIGINS`: `["*"]` or your specific frontend URLs
   - `PORT`: (Auto-generated by Render, no need to set)

5. **Deploy:**
   - Click "Create Web Service"
   - Wait 2-3 minutes for deployment
   - Your API will be live at: `https://cinepro-backend.onrender.com` (or similar)

### Important Notes:
- **Free tier sleeps after 15 minutes of inactivity** - first request after sleep takes ~30 seconds
- Upgrade to paid tier ($7/month) for always-on service
- Automatic deploys on every git push to main branch

---

## ‚úÖ Option 2: Railway.app (Great Alternative)

**Developer-friendly platform with $5 free credit monthly.**

### Deploy Steps:

1. **Go to Railway:**
   Visit https://railway.app/ and login with GitHub

2. **New Project:**
   - Click "New Project"
   - Select "Deploy from GitHub repo"
   - Choose `lamdaz/backende`

3. **Configure:**
   Railway auto-detects Node.js projects
   - It will automatically run `npm install` and `node index.js`

4. **Add Environment Variables:**
   - Click on your service ‚Üí "Variables" tab
   - Add:
     - `TMDB_API_KEY`: Your TMDB API key
     - `ALLOWED_ORIGINS`: `["*"]` or specific URLs
     - `PORT`: Railway provides this automatically

5. **Generate Domain:**
   - Go to "Settings" tab
   - Click "Generate Domain"
   - Your API will be available at the generated URL

### Pricing:
- $5 free credit per month
- Usage-based pricing after that (~$5-10/month for most apps)

---

## ‚úÖ Option 3: Fly.io (Container-Based)

**Uses Docker for deployment. Your project already has a Dockerfile!**

### Deploy Steps:

1. **Install Fly CLI:**
   ```bash
   # Linux/Mac
   curl -L https://fly.io/install.sh | sh
   
   # Windows (PowerShell)
   iwr https://fly.io/install.ps1 -useb | iex
   ```

2. **Login:**
   ```bash
   flyctl auth login
   ```

3. **Launch App:**
   ```bash
   flyctl launch
   ```
   - App name: Choose a unique name
   - Region: Select closest to your users
   - Would you like to set up a Postgresql database? ‚Üí No
   - Would you like to deploy now? ‚Üí No (we need to set env vars first)

4. **Set Environment Variables:**
   ```bash
   flyctl secrets set TMDB_API_KEY="your_actual_api_key_here"
   flyctl secrets set ALLOWED_ORIGINS='["*"]'
   flyctl secrets set PORT="8080"
   ```

5. **Deploy:**
   ```bash
   flyctl deploy
   ```

6. **Open Your App:**
   ```bash
   flyctl open
   ```

### Pricing:
- Free tier: 3 shared-cpu-1x VMs with 256MB RAM
- Sufficient for most hobby projects

---

## ‚úÖ Option 4: Koyeb (Simple & Fast)

**European-based platform with free tier.**

### Deploy Steps:

1. **Go to Koyeb:**
   Visit https://www.koyeb.com/ and sign up

2. **Create Service:**
   - Click "Create Service"
   - Select "GitHub"
   - Choose `lamdaz/backende` repository

3. **Configure:**
   - Build method: Dockerfile (auto-detected)
   - Instance type: Nano (free tier)
   - Regions: Choose closest location

4. **Environment Variables:**
   Add in the "Environment variables" section:
   - `TMDB_API_KEY`
   - `ALLOWED_ORIGINS`
   - `PORT`: 8000

5. **Deploy:**
   Click "Deploy" and wait for build to complete

---

## ‚úÖ Option 5: Cyclic.sh (Serverless but No Size Limit)

**Unique serverless platform without the 250MB restriction.**

### Deploy Steps:

1. **Go to Cyclic:**
   Visit https://www.cyclic.sh/ and login with GitHub

2. **Connect Repository:**
   - Click "Link Your Own"
   - Select `lamdaz/backende`

3. **Environment Variables:**
   Go to "Variables" tab and add:
   - `TMDB_API_KEY`
   - `ALLOWED_ORIGINS`
   - PORT is auto-configured

4. **Deploy:**
   Cyclic automatically deploys from GitHub
   Your app will be live at: `https://your-app.cyclic.app`

---

## üìù Testing Your Deployment

After deploying to any platform, test your API:

```bash
# Replace YOUR_DEPLOYED_URL with your actual URL

# Test home endpoint
curl https://YOUR_DEPLOYED_URL/

# Test movie endpoint
curl https://YOUR_DEPLOYED_URL/movie/550

# Test TV show endpoint
curl "https://YOUR_DEPLOYED_URL/tv/1399?s=1&e=1"

# Test cache stats
curl https://YOUR_DEPLOYED_URL/cache-stats
```

---

## üéØ My Recommendations

### For Beginners:
**Use Render.com** - Easiest setup with clear UI and good documentation

### For Developers:
**Use Railway.app** - Best developer experience with CLI and dashboard

### For Production:
**Use Fly.io** - Most robust, container-based, global edge network

---

## üö´ Why Netlify/Vercel Failed

Both platforms have a **250 MB size limit** for serverless functions. Your project with dependencies exceeds this:
- Heavy scraping libraries (cheerio, cloudflare-scraper)
- Multiple provider implementations
- Complete Express.js application

These platforms are designed for **lightweight functions**, not full backend applications.

---

## üì¶ Repository Ready

All configuration files are now in your repository:
- `render.yaml` - For Render.com
- `Dockerfile` - For Fly.io, Koyeb, Railway
- `docker-compose.yml` - For local development

**Repository:** https://github.com/lamdaz/backende

Push the latest changes and choose your preferred deployment platform!
